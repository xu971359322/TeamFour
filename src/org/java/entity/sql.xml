<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>

    <sql-query name="level">
        SELECT k.Lv_id,k.lv_name as lv_name ,COUNT(m.Lv_id) AS num
        FROM (SELECT Lv_id,lv_name FROM leverclient ) k
        LEFT JOIN (SELECT Lv_id, manager,credit,satisfaction FROM clientdetail) m ON k.Lv_id = m.Lv_id GROUP BY k.Lv_id ORDER BY num DESC
    </sql-query>

    <sql-query name="satisfaction">
        SELECT k.Lv_id,k.lv_name as lv_name, m.manager as manager  ,m.satisfaction AS satisfaction
        FROM (SELECT Lv_id,lv_name FROM leverclient ) k LEFT JOIN (SELECT Lv_id, manager,credit,satisfaction FROM clientdetail) m ON k.Lv_id = m.Lv_id ORDER BY k.lv_name asc
    </sql-query>

    <sql-query name="credit">
        SELECT k.Lv_id,k.lv_name as lv_name, m.manager as manager ,m.credit AS credit
        FROM (SELECT Lv_id,lv_name FROM leverclient ) k LEFT JOIN (SELECT Lv_id, manager,credit,satisfaction FROM clientdetail) m ON k.Lv_id = m.Lv_id ORDER BY k.lv_name asc
    </sql-query>

    <sql-query name="showLSCount">
        SELECT COUNT(*) AS `count`,
            CASE ctype
            WHEN 0 THEN '正常'
            WHEN 1 THEN '成功'
            WHEN 2 THEN '失败'
            WHEN 3 THEN '暂缓流失'
            WHEN 4 THEN '已流失'
            END AS stauts
        FROM `client` c GROUP BY stauts
    </sql-query>
    <sql-query name="showQuarter">
        SELECT SUBSTRING(otime,1,4) AS year,
        CASE ((MONTH(os.otime)-1) DIV 3) +1
        WHEN 1 THEN '第一季度'
        WHEN 2 THEN '第二季度'
        WHEN 3 THEN '第三季度'
        WHEN 4 THEN '第四季度'
        END AS result,
        os.otime AS time,CAST(sum(os.ocount) as char(10))  AS count
        FROM orders os,goods gs WHERE gs.gid=os.gid  GROUP BY result,year order by year desc
    </sql-query>
</hibernate-mapping>